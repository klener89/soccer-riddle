{% extends 'base.html' %}
{% block title %}Share Game {{game.id}} {% endblock %}
{% block content %}
<div class="container py-5 text-center bg_background">
    <div class="txt_on_background"><i class="fas fa-share-alt fa-2x"></i></div>
    <h3 class="py-3">You want to share the following game?</h3>
    <div class="txt_on_background py-3">Give it a personal touch and add your name and who you want to share it with
    </div>
    <div class="txt_on_background py-3">We will create a personal link for you</div>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col col-md-6">
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="yourname"><i class="fas fa-signature"></i></span>
                    </div>
                    <input id="fromName" type="text" class="form-control" placeholder="Your Name" aria-label="Your Name"
                        aria-describedby="yourname">
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="toname"><i class="fas fa-arrow-right"></i></span>
                    </div>
                    <input id="toName" type="text" class="form-control" placeholder="Share with" aria-label="Share with"
                        aria-describedby="toname">
                </div>
            </div>
        </div>
        <!-- <div class="row justify-content-center">
            <div class="col-10 col-sm-6">
                <div class="row rounded">
                    <code style="color: var(--secondary); background-color: var(--surface)" class="col-10 col-sm-11"
                        id="link_created"></code>
                    <a id="link_copy" class="btn btn-link col-2 col-sm-1">
                        <span><i class="fas fa-copy"></i></span>
                    </a>
                </div>
            </div>
        </div> -->
        <div class="row justify-content-center">
            <div class="input-group mb-3 col-10 col-sm-6">
                <input type="text" class="form-control bg-secondary" style="color:var(--secondary)"
                    aria-describedby="share-link" id="link_created">
                <div class="input-group-append">
                    <button id="link_copy" data-toggle="tooltip" title="Link copied" class="txt_secondary bg-secondary rounded-right" type="button"><i class="fas fa-copy"></i></button>
                </div>
            </div>
        </div>
        <!-- <div class="row justify-content-center">
            <a id="link_copy" class="btn btn-link col-12 col-md-10 col-xl-8">
                <kbd class="p-2 mx-2 row">
                    <span class="col-10 col-sm-11 text-truncate w-75" id="link_created"></span>
                    <span class="col-2 col-sm-1"><i class="fas fa-copy"></i></span>
                </kbd>
            </a>
        </div> -->
        <div class="p-3">
            <!-- Twitter (url, text, @mention) -->
            <a class="link" target="_blank"
                href='https://twitter.com/share?url={{ url_for("game.play", game_id=game.id, _external=True)}}&text=Find the missing teammate!&hashtags=guesswho, soccer-riddle, soccer-quiz'>
                <i class="fab fa-twitter-square fa-3x"></i>
            </a>
            <a class="link" target="_blank" onclick="
            window.open(
              'https://www.facebook.com/sharer/sharer.php?href={{ url_for("game.play", game_id=game.id, _external=True)}}',
              'facebook-share-dialog', 'width=626,height=436'); return false;">
                <i class="fab fa-facebook-square fa-3x"></i>
            </a>

            <!-- Reddit (url, title) -->
            <a class="link" target="_blank"
                href="https://reddit.com/submit?url={{ url_for("game.play", game_id=game.id, _external=True)}}&title=GuessWho - Find the missing teammate">
                <i class="fab fa-reddit-square fa-3x"></i>
            </a>

            <!-- Hacker News (url, title) -->

            <a class="link" target="_blank"
                href="https://news.ycombinator.com/submitlink?u={{ url_for("game.play", game_id=game.id, _external=True)}}&t=GuessWho - Find the missing teammate">
                <i class="fab fa-hacker-news-square fa-3x"></i>
            </a>

            <!-- LinkedIn (url, title, summary, source url) -->
            <a class="link" target="_blank"
                href="https://www.linkedin.com/shareArticle?mini=true&url={{ url_for("game.play", game_id=game.id, _external=True) | safe}}&title=Test&summary=Testsum&source={{ url_for("game.index", _external=True)}}">
                <i class="fab fa-linkedin fa-3x"></i>
            </a>

            <!-- Email (subject, body) -->
            <a class="link"
                href="mailto:?subject=I challenge you at guesswho.games - Find the missing teammate&body=url=Check out the game at {{ url_for("game.play", game_id=game.id, _external=True) | safe}}">
                <i class="fas fa-envelope-square fa-3x"></i>
            </a>
        </div>
    </div>

    <div class="container">
        <div class="table-responsive">
            <table class="table table-striped table-dark">
                <thead>
                    <tr class="text-center">
                        <th style="width:10%" scope="col"></th>
                        <th scope="col">Name</th>
                        <th scope="col">Age</th>
                        <th scope="col">Pos.</th>
                        <th scope="col">Club</th>
                    </tr>
                </thead>
                <tbody>
                    {% for player in game.players %}
                    <tr class="text-center" style="transform: rotate(0);">
                        <th scope="row">
                            <img src="{{ player.img | replace('small','header')}}"
                                class="img-fluid img-border rounded mx-auto" alt="{{ player.name }}">
                        </th>
                        <td class="align-middle">{{player.name}}</td>
                        <td class="align-middle">{{player.age}}</td>
                        <td class="align-middle">{{player.position}}</td>
                        <td class="align-middle">{{player.club}}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    var link_base = "{{ url_for('game.play', game_id=game.id, _external=True) }}";
    var linkDiv = document.getElementById('link_created');
    linkDiv.value = link_base
    var from = ""
    var to = ""

    document.getElementById('fromName').addEventListener("keyup", function () {
        var name = document.getElementById('fromName')
        from = name.value
        createLink()
    });
    document.getElementById('toName').addEventListener("keyup", function () {
        var name = document.getElementById('toName')
        to = name.value
        createLink()
    });
    function createLink() {
        var from_ = (from != "") ? ("from=" + from) : ""
        var to_ = (to != "") ? ("to=" + to) : ""
        linkDiv.value = link_base + "?" + from_ + "\&" + to_
    }

    var copyBtn = document.getElementById('link_copy')

    copyBtn.addEventListener('click', function (event) {
        var txt = document.getElementById('link_created').value
        copyTextToClipboard(txt);
        $('[data-toggle="tooltip"]').tooltip();  
    });
</script>
{% endblock %}